<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of fig_16_11_simulate_inhom_profiles_gaussian</title>
  <meta name="keywords" content="fig_16_11_simulate_inhom_profiles_gaussian">
  <meta name="description" content="% Fig. 2.9 page 51 and Fig 16.11 page 742">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../Documentation.html">Home</a> &gt;  <a href="#">16-Surface-Reconstruction</a> &gt; <a href="Documentation.html">Profile-Reconstruction</a> &gt; fig_16_11_simulate_inhom_profiles_gaussian.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../Documentation.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="Documentation.html">Index for 16-Surface-Reconstruction\Profile-Reconstruction&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>fig_16_11_simulate_inhom_profiles_gaussian
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>% Fig. 2.9 page 51 and Fig 16.11 page 742</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Fig. 2.9 page 51 and Fig 16.11 page 742 
 simulate homgeneous/inhomogeneous 1D gaussian process

 Wolfgang Förstner 2015
 last changes: Susanne Wenzel 09/16
 wfoerstn@uni-bonn.de, wenzel@igg.uni-bonn.de</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../General-Functions/Graphics/plot_init.html" class="code" title="function varargout = plot_init">plot_init</a>	% plot_init: initialize visualization</li><li><a href="../../General-Functions/Statistics/rand_gauss.html" class="code" title="function ret = rand_gauss(mu, C, n)">rand_gauss</a>	% random numbers following a multivariate Gaussian  with</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Fig. 2.9 page 51 and Fig 16.11 page 742</span>
0002 <span class="comment">% simulate homgeneous/inhomogeneous 1D gaussian process</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Wolfgang Förstner 2015</span>
0005 <span class="comment">% last changes: Susanne Wenzel 09/16</span>
0006 <span class="comment">% wfoerstn@uni-bonn.de, wenzel@igg.uni-bonn.de</span>
0007 
0008 close all
0009 clearvars
0010 
0011 addpath(genpath(<span class="string">'../General-Functions'</span>));
0012 
0013 <span class="comment">%% set your parameters ------------------------------------------</span>
0014 NoSample = 3;       <span class="comment">% number of smaples for the plot, &lt;5</span>
0015 N = 300;            <span class="comment">% number of grid points</span>
0016 
0017 <span class="comment">% parameters for homogeneous  gaussian process</span>
0018 d0 = 20;            <span class="comment">% reference distance</span>
0019 sigma = 1;          <span class="comment">% standard deviation</span>
0020 
0021 <span class="comment">% parameters for inhomogeneous  gaussian process</span>
0022 d0l = 10;               <span class="comment">% left reference distance</span>
0023 sigma_l = 0.5;          <span class="comment">% left std</span>
0024 d0r = 40;               <span class="comment">% right reference distance</span>
0025 sigma_r = 3;            <span class="comment">% right standard deviation</span>
0026 dc = 30;                <span class="comment">% smearing constant</span>
0027 
0028 <span class="comment">%---------------------------------------------------------------</span>
0029 
0030 <span class="comment">%% prepare visualization</span>
0031 <span class="comment">% line spec</span>
0032 col=[<span class="string">'k'</span>,<span class="string">'b'</span>,<span class="string">'r'</span>,<span class="string">'c'</span>,<span class="string">'m'</span>];
0033 lin=[<span class="string">'-'</span>,<span class="string">'-'</span>,<span class="string">'-'</span>,<span class="string">'-'</span>,<span class="string">'-'</span>];
0034 
0035 <span class="comment">% get current screensize, for proper positioning of figures and set default</span>
0036 <span class="comment">% plot settings</span>
0037 ss = <a href="../../General-Functions/Graphics/plot_init.html" class="code" title="function varargout = plot_init">plot_init</a>;
0038   
0039 
0040 <span class="comment">%% inhomogeneous GP</span>
0041 
0042 <span class="comment">% initiate covariance matrix</span>
0043 Sigma=zeros(N);  
0044 <span class="comment">% generate left upper covariance matrix</span>
0045 <span class="keyword">for</span> n=1:N/2
0046     <span class="keyword">for</span> m=1:N/2
0047         d=(n-m)/d0l;
0048         <span class="comment">% smear sigma using sigmoid function</span>
0049         sig = (sigma_r+(sigma_l-sigma_r)./(1+exp(-(n-N/2)./N.*dc)))*<span class="keyword">...</span>
0050               (sigma_r+(sigma_l-sigma_r)./(1+exp(-(m-N/2)./N.*dc)));
0051         Sigma(n,m)=sig*exp(-d^2/2);
0052     <span class="keyword">end</span>
0053 <span class="keyword">end</span>
0054 <span class="comment">% generate right lower covariance matrix</span>
0055 <span class="keyword">for</span> n=N/2+1:N
0056     <span class="keyword">for</span> m=N/2+1:N
0057         d=(n-m)/d0r;
0058         <span class="comment">% smear sigma using sigmoid function</span>
0059         sig = (sigma_r+(sigma_l-sigma_r)./(1+exp(-(n-N/2)./N.*dc)))*<span class="keyword">...</span>
0060               (sigma_r+(sigma_l-sigma_r)./(1+exp(-(m-N/2)./N.*dc)));
0061         Sigma(n,m)=sig*exp(-d^2/2);
0062     <span class="keyword">end</span>
0063 <span class="keyword">end</span>
0064 <span class="comment">% generate  right upper covariance matrix</span>
0065 <span class="keyword">for</span> n=1:N/2
0066     <span class="keyword">for</span> m=N/2+1:N
0067         <span class="comment">% take mean distance</span>
0068         d=abs(N/2+1/2-n)/d0l + abs(m-N/2-1/2)/d0r;
0069         <span class="comment">% smear sigma using sigmoid function</span>
0070         sig = (sigma_r+(sigma_l-sigma_r)./(1+exp(-(n-N/2)./N.*dc)))*<span class="keyword">...</span>
0071               (sigma_r+(sigma_l-sigma_r)./(1+exp(-(m-N/2)./N.*dc)));
0072         Sigma(n,m) = sig*exp(-d^2/2);
0073         <span class="comment">% fill symmetric part</span>
0074         Sigma(m,n) = Sigma(n,m);
0075     <span class="keyword">end</span>
0076 <span class="keyword">end</span>
0077 
0078 <span class="comment">% generate samples</span>
0079 y = <a href="../../General-Functions/Statistics/rand_gauss.html" class="code" title="function ret = rand_gauss(mu, C, n)">rand_gauss</a>(zeros(N,1),Sigma,NoSample);
0080 
0081 <span class="comment">% prepare plot</span>
0082 rang = N:-1:1;
0083 figure(<span class="string">'name'</span>,<span class="string">'inhomogeneous GP'</span>,<span class="string">'color'</span>,<span class="string">'w'</span>,<span class="string">'Position'</span>,[0.55*ss(1),0.2*ss(2),0.35*ss(1),0.60*ss(2)]);hold on
0084 <span class="comment">% plot samples: y + 3*sigma(smeared)</span>
0085 <span class="keyword">for</span> s = 1:NoSample
0086     plot(1:N,y(rang,s)'+<span class="keyword">...</span>
0087         3*(sigma_r+<span class="keyword">...</span>
0088         (sigma_l-sigma_r)./(1+exp(-(rang-N/2)./N*dc))),<span class="keyword">...</span>
0089         strcat(lin(s),col(s)),<span class="string">'LineWidth'</span>,3);
0090 <span class="keyword">end</span>
0091 xlabel(<span class="string">'$x$'</span>);ylabel(<span class="string">'$z$'</span>)
0092 title(<span class="string">'Fig. 16.11: Samples of inhomogeneous profiles'</span>)</pre></div>
<hr><address>Generated on Sat 21-Jul-2018 20:56:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>