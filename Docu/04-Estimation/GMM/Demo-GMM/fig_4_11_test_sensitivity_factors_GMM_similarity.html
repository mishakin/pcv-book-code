<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of fig_4_11_test_sensitivity_factors_GMM_similarity</title>
  <meta name="keywords" content="fig_4_11_test_sensitivity_factors_GMM_similarity">
  <meta name="description" content="% Fig. 4.11 test sensitivity factors in GMM with similarity">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../Documentation.html">Home</a> &gt;  <a href="#">04-Estimation</a> &gt; <a href="#">GMM</a> &gt; <a href="Documentation.html">Demo-GMM</a> &gt; fig_4_11_test_sensitivity_factors_GMM_similarity.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../Documentation.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="Documentation.html">Index for 04-Estimation\GMM\Demo-GMM&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>fig_4_11_test_sensitivity_factors_GMM_similarity
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>% Fig. 4.11 test sensitivity factors in GMM with similarity</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Fig. 4.11 test sensitivity factors in GMM with similarity

 see GMauss-Helmert model for similarity

 Wolfgang Förstner
 wfoerstn@uni-bonn.de</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../04-Estimation/GMM/Functions-GMM/GaussMarkovModelLinear_groups.html" class="code" title="function [est_x,Cov_xx,sigma_0q,R,vi,Xv,Rim,nabla_lv,muv,muv1,Um1q,Um2] =GaussMarkovModelLinear_groups(lm,Cov_ll_m,Am,av,rU)">GaussMarkovModelLinear_groups</a>	% Gauss-Markov model linear, groups of uncorrel. observations</li><li><a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>	% plot circle.</li><li><a href="../../../General-Functions/Graphics/plot_init.html" class="code" title="function varargout = plot_init">plot_init</a>	% plot_init: initialize visualization</li><li><a href="../../../General-Functions/Statistics/init_rand_seed.html" class="code" title="function seed = init_rand_seed(seed)">init_rand_seed</a>	% init_rand_seed: initialize random number generation by specific seed</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Fig. 4.11 test sensitivity factors in GMM with similarity</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% see GMauss-Helmert model for similarity</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Wolfgang Förstner</span>
0006 <span class="comment">% wfoerstn@uni-bonn.de</span>
0007 
0008 close all
0009 clearvars
0010 <span class="comment">% clear all                                                                       %#ok&lt;CLALL&gt;</span>
0011 
0012 addpath(genpath(<span class="string">'../../../General-Functions/'</span>));
0013 addpath(genpath(<span class="string">'../Functions-GMM/'</span>));
0014 
0015 disp(<span class="string">' '</span>)
0016 disp(<span class="string">' '</span>)
0017 disp(<span class="string">'===========r========================================================'</span>)
0018 disp(<span class="string">'---- Demo sensitivity factors in GMM with similarity Fig. 4.11 ----'</span>)
0019 disp(<span class="string">'-------------------------------------------------------------------'</span>)
0020 
0021 <span class="comment">%% Initiate parameters ####################################################</span>
0022 
0023 <span class="comment">% init_rand = 0;</span>
0024 init_rand = 63;            <span class="comment">% standard = 63</span>
0025 <a href="../../../General-Functions/Statistics/init_rand_seed.html" class="code" title="function seed = init_rand_seed(seed)">init_rand_seed</a>(init_rand);
0026 
0027 <span class="comment">%type of generated data (1,2 or random) -----------------------------------</span>
0028 
0029 <span class="comment">%data_type = -10;        % type of generated data</span>
0030 data_type =   2;         <span class="comment">% standard = 2</span>
0031 <span class="keyword">if</span> data_type == 0
0032     data_type = -10;
0033 <span class="keyword">end</span>
0034 
0035 <span class="comment">% statistical parameters --------------------------------------------------</span>
0036 
0037 <span class="comment">% Significance level</span>
0038 S = 0.99;
0039 
0040 <span class="comment">% Tolerance</span>
0041 tol = chi2inv(S,2);
0042 
0043 <span class="comment">% selected parameters for sensititvity analysis ---------------------------</span>
0044 <span class="comment">%</span>
0045 <span class="comment">% 1,2 = translation (alternative choice)</span>
0046 <span class="comment">% 3,4 = rotation, scale</span>
0047 
0048 rU = [3,4];
0049 
0050 <span class="comment">%% ########################################################################</span>
0051 disp(<span class="string">'--------------------------------------------'</span>)
0052 disp(<span class="string">' planar similarity with Gauss-Markov Model  '</span>)
0053 disp(<span class="string">'--------------------------------------------'</span>)
0054 
0055 
0056 <span class="comment">%% generate data ##########################################################</span>
0057 <span class="comment">% xis = a xi - b yi + c</span>
0058 <span class="comment">% yis = b xi + a yi + d</span>
0059 <span class="keyword">switch</span> data_type
0060     <span class="keyword">case</span> 1
0061         tm  = [  1, 1; <span class="keyword">...</span>
0062             2, 2; <span class="keyword">...</span>
0063             -1,-2; <span class="keyword">...</span>
0064             -2,-1 <span class="keyword">...</span>
0065             ];
0066     <span class="keyword">case</span> 2
0067         tm  = [  -7, 7 ;<span class="keyword">...</span>
0068             1, 1; <span class="keyword">...</span>
0069             2, 2; <span class="keyword">...</span>
0070             -1,-2; <span class="keyword">...</span>
0071             -2,-1; <span class="keyword">...</span>
0072             ];
0073     <span class="keyword">otherwise</span>
0074         tm=rand(-data_type,2)*5;
0075         
0076 <span class="keyword">end</span>
0077 bb   = [min(tm(:,1)),max(tm(:,1)),min(tm(:,2)),max(tm(:,2))];
0078 maxd = max(max(tm(:,1))-min(tm(:,1)),max(tm(:,2))-min(tm(:,2)));
0079 
0080 <span class="comment">% true parameters</span>
0081 xt  = [2,0.5,3,-2]';
0082 disp(<span class="string">'Parameters'</span>)
0083 disp(<span class="string">'   [ x(1)     -x(2)      x(3) ]'</span>);
0084 disp(<span class="string">'   [ x(2)      x(1)      x(4) ]'</span>);
0085 True_transformation = [xt(1) -xt(2) xt(3);xt(2) xt(1) xt(4)] <span class="comment">%#ok&lt;*NOPTS&gt;</span>
0086 
0087 <span class="comment">%tm=rand(8,2)*2;</span>
0088 N   = length(tm(:));
0089 d_I = 2;
0090 I   = N/d_I;
0091 Number_of_points = I
0092 U   = 4;
0093 sigma  = 0.01;
0094 Standard_deviation_observations_m = sigma
0095 
0096 
0097 <span class="comment">%% setup elements of estimation</span>
0098 <span class="comment">% observed coordinates</span>
0099 lm = zeros(I,d_I);
0100 <span class="comment">% design matrix A =[A_i']</span>
0101 Am = spalloc(N,U,N*U);
0102 Cov_ll_m = zeros(I,I-1);
0103 true_error = zeros(I,d_I);
0104 <span class="keyword">for</span> i =1:I
0105     true_error(i,:) = randn(2,1)*sigma;
0106     lm(i,:)         = [xt(1) -xt(2) xt(3);xt(2) xt(1) xt(4)]*[tm(i,:)';1] <span class="keyword">...</span>
0107         + true_error(i,:)';
0108     Am(2*i-1:2*i,:) = [tm(i,1) -tm(i,2) 1 0;<span class="keyword">...</span>
0109         tm(i,2)  tm(i,1) 0 1];                               <span class="comment">%#ok&lt;*SPRIX&gt;</span>
0110     Cov_ll_m(i,:)   = [1 0 0 1]*sigma^2;
0111 <span class="keyword">end</span>
0112 true_errors=true_error
0113 true_and_observed_coordinates=[tm , lm]
0114 av  = zeros(N,1);
0115 
0116 <span class="comment">%% factors for plotting</span>
0117 factor_v  = 0.5*maxd/sqrt(N)/sigma;
0118 factor_r  = 0.5*maxd/sqrt(N);
0119 factor_X  = maxd/sqrt(N)/6;
0120 factor_mu = maxd/sqrt(N)/4;
0121 factor_nv = factor_v/10;
0122 
0123 <span class="comment">%% estimate parameters</span>
0124 
0125 [est_x,Cov_xx,sigma_0q,R,vm,Xv,Rim,nabla_lv,muv,muv1,Um1q,Um2]=<span class="keyword">...</span>
0126     <a href="../../../04-Estimation/GMM/Functions-GMM/GaussMarkovModelLinear_groups.html" class="code" title="function [est_x,Cov_xx,sigma_0q,R,vi,Xv,Rim,nabla_lv,muv,muv1,Um1q,Um2] =GaussMarkovModelLinear_groups(lm,Cov_ll_m,Am,av,rU)">GaussMarkovModelLinear_groups</a>(lm,Cov_ll_m,Am,av,rU);
0127 
0128 
0129 
0130 <span class="comment">%% plot results</span>
0131 screensize = <a href="../../../General-Functions/Graphics/plot_init.html" class="code" title="function varargout = plot_init">plot_init</a>;
0132 figure(<span class="string">'Color'</span>,<span class="string">'w'</span>,<span class="string">'Position'</span>,[100 100 screensize+[-300 -300]]);
0133 
0134 subplot(2,3,1);
0135 hold on;
0136 plot(tm(:,1),tm(:,2),<span class="string">'.r'</span>,<span class="string">'Markersize'</span>,12);       <span class="comment">% given data</span>
0137 <span class="keyword">for</span> i=1:I
0138     plot([tm(i,1),tm(i,1)+factor_v*vm(i,1)],[tm(i,2),tm(i,2)+factor_v*vm(i,2)],<span class="string">'-k'</span>);
0139 <span class="keyword">end</span>
0140 title({<span class="string">'residuals [m]'</span>, strcat(<span class="string">'max='</span>,num2str(max(norm(vm(:,1:2)))))});
0141 xlim([min(tm(:,1))-1,max(tm(:,1))+1]);
0142 ylim([min(tm(:,2))-1,max(tm(:,2))+1]);
0143 axis equal;
0144 
0145 
0146 subplot(2,3,2);
0147 hold on;
0148 <span class="keyword">for</span> i=1:I
0149     <a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>(tm(i,1),tm(i,2),factor_r*Rim(i,1),<span class="string">'-r'</span>);
0150 <span class="keyword">end</span>
0151 title({<span class="string">'redundancy number'</span>, strcat(<span class="string">'min='</span>,num2str(min(Rim(:,1))))});
0152 xlim([min(tm(:,1))-factor_r*1,max(tm(:,1))+factor_r*1]);
0153 ylim([min(tm(:,2))-factor_r*1,max(tm(:,2))+factor_r*1]);
0154 axis equal;
0155 
0156 
0157 subplot(2,3,4);
0158 hold on;
0159 <span class="keyword">for</span> i=1:I
0160     <a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>(tm(i,1),tm(i,2),factor_X*sqrt(Xv(i)/d_I),<span class="string">'-k'</span>,<span class="string">'LineWidth'</span>,2);
0161     <a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>(tm(i,1),tm(i,2),factor_X*sqrt(tol/d_I),<span class="string">'--r'</span>);
0162 <span class="keyword">end</span>
0163 title({<span class="string">'test statistics'</span>, strcat(<span class="string">'max='</span>,num2str(max(sqrt(Xv/d_I)))),<span class="string">'- - - critical values'</span>});
0164 xlim([min(tm(:,1))-factor_X*5,max(tm(:,1))+factor_X*5]);
0165 ylim([min(tm(:,2))-factor_X*5,max(tm(:,2))+factor_X*5]);
0166 axis equal;
0167 
0168 subplot(2,3,3);
0169 hold on;
0170 <span class="keyword">for</span> i=1:I
0171     <a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>(tm(i,1),tm(i,2),factor_mu*muv(i),<span class="string">'-k'</span>);
0172 <span class="keyword">end</span>
0173 title({<span class="string">'sensitivity factors'</span>, strcat(<span class="string">'max='</span>,num2str(max(muv)))});
0174 xlim([min(tm(:,1))-factor_mu*5,max(tm(:,1))+factor_mu*5]);
0175 ylim([min(tm(:,2))-factor_mu*5,max(tm(:,2))+factor_mu*5]);
0176 axis equal;
0177 
0178 
0179 subplot(2,3,5);
0180 hold on;
0181 <span class="keyword">for</span> i=1:I
0182     <a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>(tm(i,1),tm(i,2),factor_nv*nabla_lv(i),<span class="string">'-r'</span>);
0183 <span class="keyword">end</span>
0184 title({<span class="string">'min. detectable outliers [m]'</span>;strcat(<span class="string">'max='</span>,num2str(max(nabla_lv)))});
0185 xlim([min(tm(:,1))-1,max(tm(:,1))+1]);
0186 ylim([min(tm(:,2))-1,max(tm(:,2))+1]);
0187 axis equal;
0188 
0189 <span class="keyword">if</span> ~isempty(rU)
0190     subplot(2,3,6);
0191     hold on;
0192     <span class="keyword">for</span> i=1:I
0193         <a href="../../../General-Functions/Graphics/plot_circle.html" class="code" title="function h = plot_circle(xo,yo,r, fmt, varargin)">plot_circle</a>(tm(i,1),tm(i,2),factor_mu*muv1(i),<span class="string">'-k'</span>);
0194     <span class="keyword">end</span>
0195     title({<span class="string">'sens. factors partial'</span>;strcat(<span class="string">'max='</span>,num2str(max(muv1)),<span class="string">', param='</span>,num2str(rU))});
0196     xlim([min(tm(:,1))-factor_mu*5,max(tm(:,1))+factor_mu*5]);
0197     ylim([min(tm(:,2))-factor_mu*5,max(tm(:,2))+factor_mu*5]);
0198     axis equal;
0199 <span class="keyword">end</span>
0200 
0201 
0202 <span class="comment">%%</span>
0203 
0204 disp(<span class="string">'.............................'</span>)
0205 disp(<span class="string">'        diagnostics          '</span>)
0206 disp(<span class="string">'.............................'</span>)
0207 Estimated_transformation = <span class="keyword">...</span>
0208     [est_x(1) -est_x(2) est_x(3);est_x(2) est_x(1) est_x(4)]
0209 Theoretical_precision_of_paramters   = full(sqrt(diag(Cov_xx)))'
0210 Redundancy              =R
0211 Estimated_sigma_0       = sqrt(sigma_0q)
0212 
0213 a________I________vx________vy_________z=<span class="keyword">...</span>
0214     [(1:I)',vm,sqrt(Xv/d_I)]
0215 
0216 [m,i]=max(sqrt(diag(true_error*true_error')));
0217 disp(horzcat(<span class="string">'Maximal true error                 = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0218     <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0219 [m,i]=max(sqrt(diag(vm*vm')));
0220 disp(horzcat(<span class="string">'Maximal residual                   = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0221     <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0222 [m,i]=min(Rim(:,1));
0223 disp(horzcat(<span class="string">'Minimal redundancy number          = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0224     <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0225 
0226 [m,i]=max(sqrt(Xv/d_I));
0227 <span class="keyword">if</span> max(Xv) &gt; tol
0228     disp(horzcat(<span class="string">'Maximal test statistic             = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0229         <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)), <span class="string">' ***'</span>);
0230 <span class="keyword">else</span>
0231     disp(horzcat(<span class="string">'Maximal test statistic             = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0232         <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0233 <span class="keyword">end</span>
0234 [m,i]=max(nabla_lv);
0235 disp(horzcat(<span class="string">'Max. of minimal detectable outlier = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0236     <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0237 
0238 [m,i]=max(muv);
0239 disp(horzcat(<span class="string">'Max. sensitivity factor            = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0240     <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0241 <span class="keyword">if</span> ~isempty(rU)
0242     [m,i]=max(muv1);
0243     disp(horzcat(<span class="string">'Max. sensitivity factor ['</span>,num2str(rU),<span class="string">']     = '</span>,num2str(m,<span class="string">'% 12.5f'</span>),<span class="keyword">...</span>
0244         <span class="string">' at: '</span>, num2str(i,<span class="string">'% 3.0f'</span>)));
0245 <span class="keyword">end</span>
0246 
0247 
0248</pre></div>
<hr><address>Generated on Sat 21-Jul-2018 20:56:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>